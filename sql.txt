SQL Statements
Inner Join 
fetch customer with their orders

SELECT c.customer_id, c.fname, c.lname, o.orderinfo_id, o.date_placed
FROM customer c, orderinfo o
WHERE c.customer_id = o.customer_id













SELECT customer.customer_id, orderinfo.orderinfo_id, customer.fname, customer.lname, customer.addressline, orderinfo.date_placed
FROM customer, orderinfo
WHERE customer.customer_id = orderinfo.customer_id

//inner Join
SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.addressline, o.date_placed
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id



SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c, orderinfo o
WHERE c.customer_id = o.customer_id

//fetch all orders from customer residing in town bingham
SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c, orderinfo o
WHERE c.customer_id = o.customer_id
AND (c.town = 'bingham' OR c.town = 'nicetown')




SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id
WHERE c.town = 'bingham'

SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c, orderinfo o
WHERE c.town = 'bingham'

SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id
WHERE c.town = 'bingham' OR c.town = 'nicetown'

SELECT c.customer_id, o.orderinfo_id, c.fname, c.lname, c.town, o.date_placed
FROM customer c, orderinfo o
WHERE c.customer_id = o.customer_id
AND (c.town = 'bingham' OR c.town = 'nicetown')

SELECT c.customer_id, c.lname, o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c, orderinfo o, orderline ol, item i
WHERE c.customer_id = o.customer_id
AND O.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
ORDER BY c.lname

SELECT c.customer_id, c.lname, o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id 
INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
ORDER BY c.lname

//fetch all orders from ann stones
SELECT c.customer_id, c.lname, c.fname, o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c, orderinfo o, orderline ol, item i
WHERE c.customer_id = o.customer_id
AND O.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND c.fname = "ann" AND c.lname = "stones"

SELECT c.customer_id, concat(c.lname, " ", c.fname) as 'customer name', o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id 
INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
WHERE c.fname = "ann" AND c.lname = "stones"

what items  were ordered on march 2000
SELECT i.description, ol.quantity, o.date_placed 
FROM orderinfo o, orderline ol, item i
WHERE o.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND month(date_placed) = 3 AND year(date_placed) = 2000


SELECT i.description, ol.quantity, o.date_placed 
FROM orderinfo o, orderline ol, item i
WHERE o.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND date_placed BETWEEN '2000-03-01' AND '2000-03-31'

SELECT i.description, ol.quantity, o.date_placed 
FROM orderinfo o INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
WHERE date_placed BETWEEN '2000-03-01' AND '2000-03-31'


fetch all customers that bought tissue
SELECT c.customer_id, c.lname, c.fname, o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c, orderinfo o, orderline ol, item i
WHERE c.customer_id = o.customer_id
AND O.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND i.description like '%tissue%'


SELECT c.customer_id, concat(c.lname, " ", c.fname) as 'customer name', o.orderinfo_id, ol.item_id, i.description, ol.quantity
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id 
INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
WHERE i.description like '%tissue%'

fetch all customers from bingham that ordered items priced at 20 pesos or more.
SELECT c.customer_id, c.lname, c.fname, o.orderinfo_id, ol.item_id, i.description, i.sell_price, ol.quantity
FROM customer c, orderinfo o, orderline ol, item i
WHERE c.customer_id = o.customer_id
AND O.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND i.sell_price >= 20

fetch all customers from bingham that ordered items priced at 20 pesos or more.
SELECT c.customer_id, c.lname, c.fname, c.town, o.orderinfo_id, ol.item_id, i.description, i.sell_price, ol.quantity
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id 
INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
WHERE i.sell_price >= 20
AND c.town = 'bingham'


fetch all customers with an 's' on their last name and the items they ordered

SELECT c.customer_id, c.lname, c.fname, o.orderinfo_id, ol.item_id, i.description, i.sell_price, ol.quantity
FROM customer c INNER JOIN orderinfo o ON c.customer_id = o.customer_id 
INNER JOIN orderline ol ON o.orderinfo_id = ol.orderinfo_id INNER JOIN item i ON ol.item_id = i.item_id
AND c.lname LIKE "%s%"
ORDER BY c.lname DESC

SELECT c.customer_id, c.lname, c.fname, o.orderinfo_id, ol.item_id, i.description, i.sell_price, ol.quantity
FROM customer c, orderinfo o, orderline ol, item i
WHERE c.customer_id = o.customer_id
AND O.orderinfo_id = ol.orderinfo_id
AND ol.item_id = i.item_id
AND c.lname LIKE "%s%"
ORDER BY c.lname DESC

INSERT 

INSERT INTO customer (title, fname, lname, addressline, town, zipcode, phone) VALUES ('mr', 'reyes', 'dave', 'blc', 'taguig', '4196', '838-9889')

INSERT INTO customer (title, fname, lname, addressline, town, zipcode, phone) VALUES ('mr', 'santos', 'jenniy', 'champaca', 'taguig', '4196', '838-9889')

INSERT INTO customer (title, fname, lname, addressline, town, zipcode, phone) VALUES ('mr', 'kirk', 'hammett', 'washington', 'taguig', '4196', NULL)

INSERT INTO customer (title, fname, lname, addressline, town, zipcode, phone) VALUES ('mr', 'kirk', NULL , 'washington', 'taguig', '4196','')

INSERT INTO item (description, cost_price, sell_price) VALUES ('keyboard mechanical', 800, 1000)

INSERT INTO item (description, cost_price, sell_price) VALUES ('pc', 800, 1000), ('keyboard', 700, 1000), ('power cord', 80, 100), ('monitor', 98, 98.90) 

INSERT INTO stock (item_id, quantity) VALUES(16, 90)

INSERT INTO customer (description, cost_price, sell_price) VALUES ('power supply', 8000, 9000);
INSERT INTO stock(item_id, quantity) VALUES (last_insert_id(), 100);

INSERT INTO orderinfo (customer_id, date_placed, date_shipped, shipping) VALUES (22, now(), now(), 100)

INSERT INTO orderinfo (customer_id, date_placed, date_shipped, shipping) VALUES (22, now(), date_add(now(), INTERVAL 7 DAY), 100)

INSERT INTO orderline (orderinfo_id, item_id, quantity)
VALUE(last_insert_id(), 1, 1), (last_insert_id(), 2,3), (last_insert_id(), 23, 10) 

UPDATE customer SET lname = 'mustaine', phone = '889-99-99' 
WHERE customer_id = 23

//do not do this
UPDATE customer SET town = 'makati'

UPDATE item SET sell_price = sell_price + 1 

DELETE FROM item where item_id = 21;
DELETE FROM item where item_id IN (14, 15, 16)

#cust.txt
Miss,Emma,Neill,21 Sheepy Lane,Hightown,NT2 1YQ,023 4245
Mr,Gavin,Neill,21 Sheepy Lane,Hightown,NT2 1YQ,023 4245
Mr,Duncan,Neill,21 Sheepy Lane,Hightown,NT2 1YQ,023 4245

LOAD DATA LOCAL INFILE 'd:/itim130-2024/cust.txt' INTO TABLE customer FIELDS TERMINATED BY ',' (title, fname, lname, addressline, town, zipcode,phone);

CREATE table tcust( 
    title char(4),
	fname varchar(32),
	lname varchar(32),
	addressline varchar(64),
	town varchar(32),
	zipcode char(10),
	phone varchar(16)
)

#mysqlimport
mysqlimport  –-local –-password --user=root --columns=title,fname,lname,addressline,town,zipcode,phone --fields-terminated-by=, db_sales_2024  d:/itim130-2024/tcust.csv 

INSERT INTO customer(title, fname,lname, addressline, town, zipcode, phone ) SELECT title, fname, lname, addressline,town,zipcode, phone FROM tcust WHERE phone != '';


